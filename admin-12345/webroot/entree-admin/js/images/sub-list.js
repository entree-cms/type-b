!function(e){var n={};function t(a){if(n[a])return n[a].exports;var o=n[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(a,o,function(n){return e[n]}.bind(null,o));return a},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=2)}([function(e,n){},,function(e,n,t){"use strict";t.r(n);t(0);var a=1;window.addEventListener("load",function(e){r()}),$(document).on("change","#input-file",function(e){var n=event.target,t=n.files[0];i(t),$(n).val("")}),$(document).on("click",'[data-class="image"]',function(e){var n=e.target,t=JSON.stringify({imgId:$(n).data("id"),src:$(n).prop("src")}),a=location.protocol+"//"+location.hostname;window.opener.postMessage(t,a)}),$(document).on("click",'[data-class="btn-del"]',function(e){var n=$(e.currentTarget).data("id");console.log(n),confirm(DEL_CFM_MSG)&&$.ajax({url:SITE_ROOT+"images/ajax-delete",type:"POST",data:{image_id:n,_csrfToken:CSRF_TOKEN},dataType:"json"}).done(function(e){e.result?$("#image-"+n).remove():alert(DEL_ERR_MSG)}).fail(function(e){alert(DEL_ERR_MSG)})});var o=function(e,n,t){var a=IMG_TPL.replace(/%IMAGE_ID%/g,e).replace(/%SRC%/g,n),o=$("#images");"prepend"===t?o.prepend(a):o.append(a)},r=function(){var e=$("body"),n=$("<div>").css({display:"none",width:"100%",height:"100%",position:"fixed",top:0,left:0,opacity:.3,"z-index":9999});e.append(n);var t=$("#overlay");e.append(t),e.on("dragover",function(e){e.stopPropagation(),e.preventDefault(),n.show(),t.fadeIn(200).css("display","flex")}),n.on("drop",function(e){e.stopPropagation(),e.preventDefault(),n.hide(),t.hide();var a=e.originalEvent.dataTransfer.files;$.each(a,function(e,n){i(n)})}),n.on("dragleave",function(e){e.stopPropagation(),e.preventDefault(),n.hide(),t.fadeOut(200)})},i=function(e){var n=new FormData;n.append("_csrfToken",CSRF_TOKEN),n.append("upfile",e),$.ajax({url:SITE_ROOT+"images/ajax-upload",type:"POST",contentType:!1,processData:!1,cache:!1,data:n,dataType:"json",success:function(e){if(!0===e.result)o(e.image.id,e.image.src,"prepend");else{var n=UP_ERR_MSG;e.error&&(n+="\n\n"+e.error),alert(n)}}})};$(document).on("click","#btn-load",function(e){++a<=Number(LAST_PAGE)&&($.ajax({url:SITE_ROOT+"/images/ajax-get-images/"+a,dataType:"json"}).done(function(e){!0===e.result&&$.each(e.images,function(e,n){o(n.id,n.src,"append")})}),a>=LAST_PAGE&&$("#load-img").hide())})}]);